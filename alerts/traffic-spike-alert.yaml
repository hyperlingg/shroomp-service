displayName: "Traffic Spike - Shroomp Backend"
documentation:
  content: |
    Request rate has increased significantly compared to baseline.

    ## Possible Causes:
    - Legitimate traffic spike (viral post, marketing campaign)
    - DDoS or bot attack
    - Misconfigured client making excessive requests
    - Retry storms

    ## Action Items:
    1. Check request sources in Cloud Run logs
    2. Review error rates alongside request volume
    3. Consider scaling limits or rate limiting
    4. Monitor costs in GCP billing

    Dashboard: https://console.cloud.google.com/monitoring
  mimeType: text/markdown
conditions:
  - displayName: "Request rate increased by 50%"
    conditionThreshold:
      filter: |
        resource.type = "cloud_run_revision"
        resource.labels.service_name = "shroomp-backend"
        metric.type = "logging.googleapis.com/user/request_count"
      aggregations:
        - alignmentPeriod: 60s
          perSeriesAligner: ALIGN_RATE
      comparison: COMPARISON_GT
      thresholdValue: 2.0  # Low threshold for demo/testing (requests/second)
      duration: 60s  # Reduced to 1 minute for faster demo
combiner: OR
notificationChannels: []
alertStrategy:
  autoClose: 1800s  # 30 minutes
